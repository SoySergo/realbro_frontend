# MapDrawPolygon

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º—É–ª—å—Ç–∏–ø–æ–ª–∏–≥–æ–Ω–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ Mapbox —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- **–†–∏—Å–æ–≤–∞–Ω–∏–µ –ø–æ–ª–∏–≥–æ–Ω–æ–≤**: –ö–ª–∏–∫–∏ –ø–æ –∫–∞—Ä—Ç–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ—á–µ–∫ (–º–∏–Ω–∏–º—É–º 3 —Ç–æ—á–∫–∏)
- **–®–∞–≥ –Ω–∞–∑–∞–¥**: –û—Ç–º–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–π —Ç–æ—á–∫–∏
- **Drag-and-drop**: –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ç–æ—á–µ–∫ –ø–æ–ª–∏–≥–æ–Ω–∞ –∑–∞–∂–∞—Ç–∏–µ–º –º—ã—à–∏
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ª–∏–≥–æ–Ω—ã**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤
- **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –ø–æ–ª–∏–≥–æ–Ω—ã
- **–£–¥–∞–ª–µ–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤ –∏–ª–∏ –≤—Å–µ—Ö —Å—Ä–∞–∑—É

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### MapDrawControls
–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É:
- **–ù–∞—á–∞—Ç—å —Ä–∏—Å–æ–≤–∞–Ω–∏–µ** - –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º —Ä–∏—Å–æ–≤–∞–Ω–∏—è
- **–û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë** - —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –ø–æ–ª–∏–≥–æ–Ω—ã (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–æ–≥–¥–∞ –µ—Å—Ç—å –ø–æ–ª–∏–≥–æ–Ω—ã)

#### PolygonEditor
–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏ —Ä–∏—Å–æ–≤–∞–Ω–∏–∏ (–≤–æ–∑–ª–µ –ø–µ—Ä–≤–æ–π —Ç–æ—á–∫–∏):
- **‚úì –°–æ—Ö—Ä–∞–Ω–∏—Ç—å** - –∑–∞–≤–µ—Ä—à–∏—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª–∏–≥–æ–Ω (–∞–∫—Ç–∏–≤–Ω–∞ –ø—Ä–∏ ‚â•3 —Ç–æ—á–∫–∞—Ö)
- **‚Ü∂ –®–∞–≥ –Ω–∞–∑–∞–¥** - –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Ç–æ—á–∫—É
- **‚úï –û—Ç–º–µ–Ω–∏—Ç—å** - –æ—Ç–º–µ–Ω–∏—Ç—å —Ä–∏—Å–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é

#### PolygonActions
–í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π –ø–æ–ª–∏–≥–æ–Ω:
- **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å** - –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø–æ–ª–∏–≥–æ–Ω –≤ —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **üóë –£–¥–∞–ª–∏—Ç—å** - —É–¥–∞–ª–∏—Ç—å –ø–æ–ª–∏–≥–æ–Ω

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∫–∞—Ä—Ç–æ–π

**–ö–ª–∏–∫–∏ –ø–æ –∫–∞—Ä—Ç–µ**:
- –í —Ä–µ–∂–∏–º–µ —Ä–∏—Å–æ–≤–∞–Ω–∏—è: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–µ–∫
- –ö–ª–∏–∫ –Ω–∞ –ø–æ–ª–∏–≥–æ–Ω: –º–µ–Ω—é –¥–µ–π—Å—Ç–≤–∏–π (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å)

**Drag-and-drop —Ç–æ—á–µ–∫**:
- –ù–∞–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ —Ç–æ—á–∫—É: –∫—É—Ä—Å–æ—Ä –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `move`
- –ó–∞–∂–∞—Ç–∏–µ —Ç–æ—á–∫–∏: —Ä–µ–∂–∏–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è (`grab` ‚Üí `grabbing`)
- –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**:
- **–¢–µ–∫—É—â–∏–π –ø–æ–ª–∏–≥–æ–Ω** (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∏—Å–æ–≤–∞–Ω–∏—è):
  - –°–∏–Ω—è—è –∑–∞–ª–∏–≤–∫–∞ (#198BFF, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å 0.3)
  - –°–∏–Ω–∏–µ –ª–∏–Ω–∏–∏ –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏
  - –¢–æ—á–∫–∏: –ø–µ—Ä–≤–∞—è –∑–µ–ª—ë–Ω–∞—è (#28A745), –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–∏–Ω–∏–µ
- **–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –ø–æ–ª–∏–≥–æ–Ω—ã**:
  - –ó–µ–ª—ë–Ω–∞—è –∑–∞–ª–∏–≤–∫–∞ (#28A745, –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å 0.4)
  - –ñ—ë–ª—Ç–∞—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ (#FFC107)

### –¢–∏–ø—ã

**–§–∞–π–ª**: `src/types/draw.ts`

```typescript
type DrawPoint = { lng: number; lat: number };
type DrawPolygon = { id: string; points: DrawPoint[]; createdAt: Date };
type DrawMode = 'idle' | 'drawing' | 'editing';
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```tsx
import { MapDrawPolygon } from '@/components/features/map/MapDrawPolygon';

<MapDrawPolygon map={mapInstance} />
```

**–ü—Ä–æ–ø—Å—ã**:
- `map: mapboxgl.Map` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–∞—Ä—Ç—ã Mapbox

### –°–ª–æ–∏ –∫–∞—Ä—Ç—ã

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–∑–¥–∞—ë—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–ª–æ–∏:
- `drawing-polygon` (source) - —Ç–µ–∫—É—â–∏–π –ø–æ–ª–∏–≥–æ–Ω –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∏—Å–æ–≤–∞–Ω–∏—è
- `drawing-polygon-points` (source) - —Ç–æ—á–∫–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª–∏–≥–æ–Ω–∞
- `drawing-polygon-fill` - –∑–∞–ª–∏–≤–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª–∏–≥–æ–Ω–∞
- `drawing-polygon-line` - –ª–∏–Ω–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª–∏–≥–æ–Ω–∞
- `drawing-polygon-points` (layer) - —Ç–æ—á–∫–∏ –∫–∞–∫ –∫—Ä—É–≥–∏
- `completed-polygons` (source) - –≤—Å–µ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –ø–æ–ª–∏–≥–æ–Ω—ã
- `completed-polygons-fill` - –∑–∞–ª–∏–≤–∫–∞ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤
- `completed-polygons-line` - –≥—Ä–∞–Ω–∏—Ü—ã –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –ø–æ–ª–∏–≥–æ–Ω–æ–≤

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ª–æ–≥–∏ (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π):
- `Point added:` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ç–æ—á–∫–∞
- `Undo last point, remaining:` - –æ—Ç–º–µ–Ω–µ–Ω–∞ —Ç–æ—á–∫–∞
- `Polygon completed:` - –ø–æ–ª–∏–≥–æ–Ω –∑–∞–≤–µ—Ä—à—ë–Ω
- `Editing polygon:` - –Ω–∞—á–∞—Ç–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- `Deleted polygon:` - –ø–æ–ª–∏–≥–æ–Ω —É–¥–∞–ª—ë–Ω
- `All polygons cleared` - –≤—Å–µ –ø–æ–ª–∏–≥–æ–Ω—ã –æ—á–∏—â–µ–Ω—ã
- `Started dragging point:` - –Ω–∞—á–∞—Ç–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ
- `Finished dragging point:` - –∑–∞–≤–µ—Ä—à–µ–Ω–æ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ

**–§–∞–π–ª—ã**: 
- `src/components/features/map/MapDrawPolygon.tsx`
- `src/components/features/map/MapDrawControls.tsx`
- `src/components/features/map/PolygonEditor.tsx`
- `src/components/features/map/PolygonActions.tsx`
